import{r as u,a7 as m,F as T,R as S,j as e,S as P,B as w}from"./index-d3b06103.js";import{H as k,a as A,T as I,b as L,c as d,C as z}from"./Pagination-f3ae1c4f.js";import{R as B}from"./RoomService-1dafd3c6.js";import{T as N,C as f}from"./Table-4da1d017.js";import{C as D}from"./Chip-61747c2a.js";import"./useControlled-c0ad3f19.js";import"./useEventCallback-0e03fb6b.js";import"./ModalDialog-1b8aa38f.js";import"./Select-ca67cd63.js";const H=()=>{const[x,n]=u.useState([]),[i,p]=u.useState(1),[o,h]=u.useState(5),[l,r]=u.useState({room_id:"",reservation_date:"",start_time:"",end_time:"",reservation_reason:""}),s=u.useCallback(async()=>{const a=await B.getReservationList({page:i,pageSize:o});return n(a.reservelist),a.data},[i,o]);return u.useEffect(()=>{s()},[s,i,o]),{page:i,rowsPerPage:o,reservationData:l,reservedtList:x,handleChangePage:async a=>{p(a),await s()},handleChangeRowsPerPage:async a=>{h(a),p(1),await s()},fetchReservedList:s,updateReservationStatus:async(a,j)=>{const t=a;try{const c=await m.patch("/reservation/updatestatus",{},{params:{reservation_id:j,reservation_status:t}});return await s(),c.data}catch{T.error("Time slot is not available")}},reserveRoom:async()=>{const a=await m.post("/reservation/reserve",{...l});return await s(),a.data},searchRoom:async()=>(await m.post("/reservation/searchroom",{room_capacity:"",room_level:"",room_type:"",room_number:"",reservation_date:"",start_time:"",end_time:""})).data,setReservationData:r}},G=()=>{const{page:x,rowsPerPage:n,handleChangePage:i,handleChangeRowsPerPage:p,reservedtList:o,fetchReservedList:h,updateReservationStatus:l}=H(),[r,s]=S.useState([]),[g,b]=S.useState(!1),C=t=>{const c=r.includes(t)?r.filter(v=>v!==t):[...r,t];s(c)},y=()=>{const t=o.map(v=>v.reservation_id);s(g?[]:t),b(!g)},_=async()=>{for(const t of r)await l("0",t);await h(),s([])},a=async()=>{for(const t of r)await l("2",t);await h(),s([])},j=async()=>{for(const t of r)await l("1",t);await h(),s([])};return e.jsxs(k,{children:[e.jsxs(A,{children:[e.jsx(P,{sx:{"--TableCell-height":"40px","--TableHeader-height":"calc(1 * var(--TableCell-height))","--Table-firstColumnWidth":"80px","--Table-lastColumnWidth":"144px","--TableRow-stripeBackground":"rgba(0 0 0 / 0.04)","--TableRow-hoverBackground":"rgba(0 0 0 / 0.08)",height:346,overflow:"auto",backgroundColor:"nav.bg"},children:e.jsxs(N,{className:"table mb-0",borderAxis:"bothBetween",stickyHeader:!0,hoverRow:!0,sx:{"--Table-headerUnderlineThickness":"1px","--TableCell-paddingX":"10px","--TableCell-paddingY":"7px","& tr > *:first-of-type":{position:"sticky",zIndex:1,left:0,boxShadow:"1px 0 var(--TableCell-borderColor)"},"& tr > *:last-child":{position:"sticky",right:0,bgcolor:"var(--TableCell-headBackground)"}},children:[e.jsxs(I,{children:[e.jsxs("tr",{children:[e.jsx("th",{style:{width:150},children:"No"}),e.jsx("th",{style:{width:200},children:"Name"}),e.jsx("th",{style:{width:150},children:"Room"}),e.jsx("th",{style:{width:150},children:"Account Type"}),e.jsx("th",{style:{width:150},children:"Reason"}),e.jsx("th",{style:{width:150},children:"Status"}),e.jsx("th",{style:{width:150},children:"Reservation Date"}),e.jsx("th",{style:{width:150},children:"Start Time"}),e.jsx("th",{style:{width:150},children:"End Time"}),e.jsx("th",{style:{width:150},children:"Action"})]}),e.jsxs("tr",{children:[e.jsx("th",{}),e.jsx("th",{}),e.jsx("th",{}),e.jsx("th",{}),e.jsx("th",{}),e.jsx("th",{}),e.jsx("th",{}),e.jsx("th",{}),e.jsx("th",{}),e.jsx("th",{children:e.jsx(f,{checked:g,onChange:y,color:"primary",disabled:!1,size:"md"})})]})]}),e.jsx(L,{children:Array.isArray(o)&&o.map((t,c)=>e.jsxs("tr",{className:"text-center",children:[e.jsx("th",{children:(x-1)*n+c+1}),e.jsx("th",{children:e.jsx(d,{title:t.fullname,arrow:!0,children:e.jsx("span",{children:t.fullname})})}),e.jsx("th",{children:e.jsx(d,{title:t.room_number,arrow:!0,children:e.jsx("span",{children:t.room_number})})}),e.jsx("th",{children:e.jsx(d,{title:t.account_type,arrow:!0,children:e.jsx("span",{children:t.account_type})})}),e.jsx("th",{children:e.jsx(d,{title:t.reservation_reason,arrow:!0,children:e.jsx("span",{children:t.reservation_reason})})}),e.jsx("th",{children:e.jsx(d,{title:t.reservation_status,arrow:!0,children:e.jsx("span",{children:e.jsx(D,{color:t.reservation_status==="Cancel"?"danger":t.reservation_status==="In progress"?"warning":"success",variant:"solid",size:"lg",children:t.reservation_status})})})}),e.jsx("th",{children:e.jsx(d,{title:R(t.reservation_date),arrow:!0,children:e.jsx("span",{children:R(t.reservation_date)})})}),e.jsx("th",{children:e.jsx(d,{title:t.start_time,arrow:!0,children:e.jsx("span",{children:t.start_time})})}),e.jsx("th",{children:e.jsx(d,{title:t.end_time,arrow:!0,children:e.jsx("span",{children:t.end_time})})}),e.jsx("th",{children:e.jsx(f,{checked:r.includes(t.reservation_id),onChange:()=>C(t.reservation_id),color:"primary",disabled:!1,size:"md"})})]},t.id||c))})]})}),e.jsx("div",{className:"pagination-container",children:e.jsx(z,{count:100,page:x,rowsPerPage:n,onPageChange:i,onRowsPerPageChange:p})})]}),e.jsxs("div",{className:"d-flex mx-auto gap-3 mt-3",children:[e.jsx(w,{color:"success",size:"lg",onClick:a,disabled:r.length===0,children:"Approve"}),e.jsx(w,{color:"warning",size:"lg",onClick:j,disabled:r.length===0,children:"In Progress"}),e.jsx(w,{color:"danger",size:"lg",onClick:_,disabled:r.length===0,children:"Cancel"})]})]})},R=x=>{const n=new Date(x),i=n.getFullYear(),p=(n.getMonth()+1).toString().padStart(2,"0"),o=n.getDate().toString().padStart(2,"0"),h=n.getHours().toString().padStart(2,"0"),l=n.getMinutes().toString().padStart(2,"0");return`${o}/${p}/${i} ${h}:${l}`};export{G as default};
