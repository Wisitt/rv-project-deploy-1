import{r as p,R as b,j as e,S as k,B as m,a1 as v}from"./index-bd07fbd0.js";import{R as I}from"./RoomService-c8fe411e.js";import{H as _,a as A,T as L,b as N,c as u,C as z}from"./Pagination-e67015c6.js";import{T as B,C as w}from"./Table-8b23f94b.js";import{C as $}from"./Chip-5cfc0777.js";import"./useControlled-138fc601.js";import"./useEventCallback-469884d9.js";import"./Select-9b9debbb.js";import"./FormControlContext-cf683adc.js";const H=()=>{const[i,a]=p.useState([]),[n,d]=p.useState(1),[c,r]=p.useState(5),s=p.useCallback(async()=>{const o=await I.getAdminReportList({page:n,pageSize:c});return a(o),o.data},[n,c]);return p.useEffect(()=>{s()},[s]),{reportList:i,page:n,rowsPerPage:c,handleChangePage:async o=>{d(o),await s()},handleChangeRowsPerPage:async o=>{r(o),d(1),await s()},fetchReportList:s}},G=()=>{const{reportList:i,page:a,rowsPerPage:n,handleChangePage:d,handleChangeRowsPerPage:c,fetchReportList:r}=H(),[s,h]=b.useState([]),[x,o]=b.useState(!1),f=t=>{const l=s.includes(t)?s.filter(g=>g!==t):[...s,t];h(l)},S=()=>{const t=i.map(g=>g.report_id);h(x?[]:t),o(!x)},j=async(t,l)=>{const g=l==="Cancel"?"0":l==="In Progress"?"1":"2",R=await v.patch(`/admin/updatereportstatus/${t}`,{report_status:g});return await r(),R.data},P=async()=>{for(const t of s)await j(Number(t),"Cancel");await r(),h([])},y=async()=>{for(const t of s)await j(Number(t),"Approve");await r(),h([])},T=async()=>{for(const t of s)await j(Number(t),"In Progress");await r(),h([])};return p.useEffect(()=>{r()},[r,a,n]),e.jsxs(_,{children:[e.jsxs(A,{children:[e.jsx(k,{sx:{"--TableCell-height":"40px","--TableHeader-height":"calc(1 * var(--TableCell-height))","--Table-firstColumnWidth":"80px","--Table-lastColumnWidth":"144px","--TableRow-stripeBackground":"rgba(0 0 0 / 0.04)","--TableRow-hoverBackground":"rgba(0 0 0 / 0.08)",height:331,overflow:"auto",backgroundColor:"nav.bg"},children:e.jsxs(B,{className:"table mb-0",borderAxis:"bothBetween",stickyHeader:!0,hoverRow:!0,sx:{"--Table-headerUnderlineThickness":"1px","--TableCell-paddingX":"10px","--TableCell-paddingY":"7px","& tr > *:first-of-type":{position:"sticky",zIndex:1,left:0,boxShadow:"1px 0 var(--TableCell-borderColor)"},"& tr > *:last-child":{position:"sticky",right:0,bgcolor:"var(--TableCell-headBackground)"}},children:[e.jsxs(L,{children:[e.jsxs("tr",{children:[e.jsx("th",{style:{width:50},children:"No"}),e.jsx("th",{style:{width:150},children:"Name"}),e.jsx("th",{style:{width:150},children:"Room"}),e.jsx("th",{style:{width:150},children:"Report"}),e.jsx("th",{style:{width:150},children:"Date time"}),e.jsx("th",{style:{width:150},children:"Status"}),e.jsx("th",{style:{width:50},children:"Select"})]}),e.jsxs("tr",{children:[e.jsx("th",{}),e.jsx("th",{}),e.jsx("th",{}),e.jsx("th",{}),e.jsx("th",{}),e.jsx("th",{}),e.jsx("th",{children:e.jsx(w,{checked:x,onChange:S,color:"primary",disabled:!1,size:"md"})})]})]}),e.jsx(N,{children:i.map((t,l)=>e.jsxs("tr",{className:"text-center",children:[e.jsx("th",{children:(a-1)*n+l+1}),e.jsx("th",{children:e.jsx(u,{title:t.fullname,arrow:!0,children:e.jsx("span",{children:t.fullname})})}),e.jsx("th",{children:e.jsx(u,{title:t.room_number,arrow:!0,children:e.jsx("span",{children:t.room_number})})}),e.jsx("th",{children:e.jsx(u,{title:t.report_detail,arrow:!0,children:e.jsx("span",{children:t.report_detail})})}),e.jsx("th",{children:e.jsx(u,{title:C(t.timestamp),arrow:!0,children:e.jsx("span",{children:C(t.timestamp)})})}),e.jsx("th",{children:e.jsx($,{color:t.report_status===0?"danger":t.report_status===1?"warning":"success",variant:"solid",size:"lg",children:t.report_status===0?"Cancel":t.report_status===1?"In Progress":"Approve"})}),e.jsx("th",{children:e.jsx(w,{checked:s.includes(t.report_id),onChange:()=>f(t.report_id),color:"primary",disabled:!1,size:"md"})})]},t.id||l))})]})}),e.jsx("div",{className:"pagination-container",children:e.jsx(z,{count:100,page:a,rowsPerPage:n,onPageChange:d,onRowsPerPageChange:c})})]}),e.jsxs("div",{className:"d-flex mx-auto gap-3 mt-3",children:[e.jsx(m,{color:"success",size:"lg",onClick:y,disabled:s.length===0,children:"Approve"}),e.jsx(m,{color:"warning",size:"lg",onClick:T,disabled:s.length===0,children:"In Progress"}),e.jsx(m,{color:"danger",size:"lg",onClick:P,disabled:s.length===0,children:"Cancel"})]})]})},C=i=>{const a=new Date(i),n=a.getFullYear(),d=(a.getMonth()+1).toString().padStart(2,"0"),c=a.getDate().toString().padStart(2,"0"),r=a.getHours().toString().padStart(2,"0"),s=a.getMinutes().toString().padStart(2,"0");return`${c}/${d}/${n} ${r}:${s}`};export{G as default};
