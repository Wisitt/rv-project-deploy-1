import{J as de,K as ce,P as W,_ as y,Q as De,V as te,W as Me,r as a,X as me,Y as he,Z as pe,b as ue,j as e,$ as xe,d as ge,a0 as Ne,T as I,B as b,u as Ie,C as S,p as Ee,t as Pe,a1 as U,G as p,U as re}from"./index-bd07fbd0.js";import{d as q,L as k}from"./useMobilePicker-f4f29c97.js";import{N as A,D as se,T as Y,a as z,S as L,O}from"./TimePicker-fed58599.js";import{R as Fe}from"./RoomService-c8fe411e.js";import{c as fe}from"./cardOverflowClasses-6b415049.js";import{G as f}from"./Grid-cc899c58.js";import{d as He,M as ae}from"./Modal-47ea7b4d.js";import{F as d}from"./DialogActions-cb15ede7.js";import{D as ne}from"./DatePicker-f4314872.js";import{M as ie}from"./ModalDialog-cb89a8c8.js";import{F as v,I as $}from"./FormControl-0effa5e0.js";import"./index-677c1661.js";import"./styled-ee573952.js";import"./Typography-40bc49a3.js";import"./Paper-862ef224.js";import"./useControlled-138fc601.js";import"./useEventCallback-469884d9.js";import"./useMediaQuery-a8cdde77.js";import"./useFormControl-b799abd8.js";import"./ownerWindow-ac4bdde2.js";import"./createSvgIcon-d571b62c.js";import"./DialogContext-fbabc464.js";import"./Select-9b9debbb.js";import"./FormControlContext-cf683adc.js";function Ye(s){return de("MuiCardActions",s)}ce("MuiCardActions",["root"]);const ze=["className","component","children","buttonFlex","orientation","slots","slotProps"],Le=()=>xe({root:["root"]},Ye,{}),Oe=W("div")(({ownerState:s})=>{var i;return y({"--Button-radius":"var(--Card-childRadius)","--IconButton-radius":"var(--Card-childRadius)",display:"flex"},((i=s.orientation)==null?void 0:i.startsWith("horizontal"))&&{alignItems:"center"},{flexDirection:s.orientation==="horizontal"?"row":"column"},s.orientation==="horizontal-reverse"&&{flexDirection:"row-reverse"},{zIndex:1,gap:"calc(0.625 * var(--Card-padding))",padding:"var(--unstable_padding)","--unstable_padding":"calc(0.75 * var(--Card-padding)) 0 0 0",[`.${fe.root} > &`]:{"--unstable_padding":"calc(0.75 * var(--Card-padding)) 0 var(--Card-padding)"},[`.${Me.root} > .${He.root} + &`]:{"--unstable_padding":"0"}},s.buttonFlex?{[`& > :not(.${De.root})`]:{flex:s.buttonFlex},[`& > :not(button) > .${te.root}`]:{width:"100%"}}:{[`& > .${te.root}:only-child`]:{flex:"auto"}})}),$e=W(Oe,{name:"JoyCardActions",slot:"Root",overridesResolver:(s,i)=>i.root})({}),We=a.forwardRef(function(i,x){const l=me({props:i,name:"JoyCardActions"}),{className:n,component:g="div",children:C,buttonFlex:_,orientation:c="horizontal",slots:T={},slotProps:m={}}=l,D=he(l,ze),h=y({},D,{component:g,slots:T,slotProps:m}),M=y({},l,{component:g,buttonFlex:_,orientation:c}),j=Le(),[N,R]=pe("root",{ref:x,className:ue(j.root,n),elementType:$e,externalForwardedProps:h,ownerState:M});return e.jsx(N,y({},R,{children:C}))}),Ge=We;function Ue(s){return de("MuiCardContent",s)}ce("MuiCardContent",["root"]);const qe=["className","component","children","orientation","slots","slotProps"],Be=()=>xe({root:["root"]},Ue,{}),Je=W("div")(({ownerState:s})=>({display:"flex",flexDirection:s.orientation==="horizontal"?"row":"column",flex:9999,zIndex:1,columnGap:"var(--Card-padding)",rowGap:"max(2px, calc(0.1875 * var(--Card-padding)))",padding:"var(--unstable_padding)",[`.${fe.root} > &`]:{"--unstable_padding":"calc(var(--Card-padding) * 0.75) 0px"}})),Xe=W(Je,{name:"JoyCardContent",slot:"Root",overridesResolver:(s,i)=>i.root})({}),Ke=a.forwardRef(function(i,x){const l=me({props:i,name:"JoyCardContent"}),{className:n,component:g="div",children:C,orientation:_="vertical",slots:c={},slotProps:T={}}=l,m=he(l,qe),D=y({},m,{component:g,slots:c,slotProps:T}),h=y({},l,{component:g,orientation:_}),M=Be(),[j,N]=pe("root",{ref:x,className:ue(M.root,n),elementType:Xe,externalForwardedProps:D,ownerState:h});return e.jsx(j,y({},N,{children:C}))}),Qe=Ke,Ve=ge(Ne)`
  width: 250px;
  height: 280px;
  backdrop-filter: blur(0px);  
  transition: all 0.3s;
  background-color: rgba(24, 43, 60, 0.089);
  background-color: ${({theme:s})=>s.palette.background.backdrop};

  &::before,
  &::after {
    width: 100%;
    height: 50%;
    position: absolute;
    content: '';
    z-index: -20;
    transition: all 0.3s;

    &::before {
      top: 0;
      right: 0;
    }

    &::after {
      bottom: 0;
      left: 0;
    }
  }

  &:hover {
    &::before {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      transform: translate(90px, -105px);
      background-color: #AA96DA;
    }
    
    &::after {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      transform: translate(-90px, 60px);
      background-color: #AA96DA;
    }
    
    .content-card-user {
      color: #a6bfd3;
    }
  }
`,Ze=ge(Qe)`
  width: 100%;
  height: 100%;
  background-color: rgba(24, 43, 60, 0.089);
  backdrop-filter: blur(50px);
  border: 0.5px solid #fff;
  border-radius: 6px;
  box-shadow: 0 0 30px rgb(4 19 33 / 31%);
  transition: all 0.4s;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
`,le=({data:s,isRecommended:i,onConfirmClick:x,onReportClick:l})=>e.jsx(f,{container:!0,spacing:2,sx:{display:"flex",justifyContent:"center",alignItems:"center",gap:2},children:s.map((n,g)=>e.jsxs(Ve,{className:"card-user",sx:{display:"flex",justifyContent:"center",alignItems:"center",gap:2},children:[e.jsxs(Ze,{className:"content-card-user",children:[i&&e.jsxs(I,{variant:"outlined",color:"success",sx:{width:"80%",borderRadius:"10px",display:"flex"},children:[e.jsx("img",{src:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Telegram-Animated-Emojis/main/Activity/Sparkles.webp",alt:"Sparkles",width:"25",height:"25"}),"Recommended"]}),e.jsxs(I,{children:["ชั้น : ",n.room_level]}),e.jsxs(I,{children:["รูปแบบห้อง : ",n.room_type]}),e.jsxs(I,{children:["ห้อง : ",n.room_number]})]}),e.jsxs(Ge,{sx:{display:"flex",justifyContent:"end"},children:[e.jsx(b,{onClick:()=>x(n.room_id,n.room_number),sx:{borderRadius:"20px"},variant:"outlined",children:"Confirm"}),e.jsx(b,{color:"danger",onClick:()=>l(n.room_id,n.room_number),sx:{borderRadius:"20px"},variant:"outlined",children:"Report"})]})]},n.room_id||g))}),wo=()=>{const[s,i]=a.useState(null),[x,l]=a.useState(null),[n,g]=a.useState(""),[C,_]=a.useState(""),[c,T]=a.useState(q()),[m,D]=a.useState(q().startOf("day").hour(8)),[h,M]=a.useState(q().startOf("day").hour(9)),[j,N]=a.useState({id:"",room_id:"",room_capacity:"",room_level:"",room_type:"",room_number:"",reservation_date:"",start_time:"",end_time:""}),[R,je]=a.useState({availableRooms:[]}),[G,ve]=a.useState({recommended_rooms:[],message:""}),[be,ye]=a.useState([]),[Ce,_e]=a.useState([]),Re=["10","20","30","40","55"],[B,E]=a.useState(!1),[J,P]=a.useState(!1),[X,w]=a.useState({id:"",room_id:"",room_number:"",reservation_date:"",reservation_reason:"",start_time:"",end_time:""}),[we,Se]=a.useState([]);a.useEffect(()=>{s&&(async()=>{if(s)try{const t=await U.get(`/admin/room/getroomnumber/${s}`);Se(t.data)}catch(t){console.error("Error fetching room numbers:",t)}})()},[s]),a.useEffect(()=>{(async()=>{try{const t=await U.get("/admin/room/getroomtype/{roomtype_id}");ye(t.data.room_types)}catch(t){console.error("Error fetching room types:",t)}})()},[]),a.useEffect(()=>{(async()=>{try{const t=await U.get("/admin/room/getroomlevel");_e(t.data.roomlevel)}catch(t){console.error("Error fetching room types:",t)}})()},[]);const F=async o=>{const{name:t,value:r}=o.target;N(u=>({...u,[t]:r}))},ke=async()=>{const o=m==null?void 0:m.format("HH:00"),t=h==null?void 0:h.format("HH:00");if(o&&t){const r=parseInt(o.split(":")[0]),u=parseInt(t.split(":")[0]);if(r<8||u>18){p.error("Invalid time range. Please select a time between 08:00 and 18:00.");return}}try{const r=await Fe.searchRoom({room_capacity:j.room_capacity,room_level:j.room_level,room_type:j.room_type,room_number:j.room_number,reservation_date:(c==null?void 0:c.format("YYYY-MM-DD"))||"",start_time:o||"",end_time:t||""});ve({message:r.message||"",recommended_rooms:r.recommended_rooms||[]}),je(u=>({...u,availableRooms:r.availableRooms||[],message:r.message||""})),r.availableRooms&&r.availableRooms.length>0?p.success("Available rooms found."):r.status===500&&p.error(r.message||"Internal server error"),r.recommended_rooms&&r.recommended_rooms.length>0?p.info("Recommended rooms found."):(!r.availableRooms||r.availableRooms.length===0)&&p.error("No recommended rooms found.")}catch{p.error("No rooms found")}},H=()=>{E(!1),P(!1),_(""),g("")},Ae=async()=>{var o,t;if(x!==null){const r=R.availableRooms.find(u=>u.room_id===x);if(r)try{const u=await re.reserveRoom({room_id:r.room_id,reservation_date:(c==null?void 0:c.format("YYYY-MM-DD"))||"",start_time:(m==null?void 0:m.format("HH:00"))||"",end_time:(h==null?void 0:h.format("HH:00"))||"",reservation_reason:C,room_number:r.room_number});E(!1),p.success(u.message||"Reservation confirmed successfully")}catch(u){p.error(((t=(o=u.response)==null?void 0:o.data)==null?void 0:t.message)||"Reservation failed")}else p.error("Please select a room before confirming reservation")}},Te=async()=>{if(x!==null)try{const o=await re.reportRoom({room_id:x,report_detail:n});P(!1),p.success(o.message||"Reported successfully")}catch{p.error("All fields are required")}else p.error("Please select a room before reporting")},K=o=>{T(o)},Q=o=>{D(o)},V=o=>{M(o)},Z=o=>{const t=o.hour();return t<8||t>18},ee=o=>{const t=o.hour();return t<9||t>18},{mode:oe}=Ie();return e.jsxs("div",{className:"py-24 sm:py-32 md:py-40 relative",style:{width:"100%",height:"100vh",position:"relative",maxHeight:"calc(100vh - 0px)",overflowY:"auto",...oe==="dark"?{background:"linear-gradient(to bottom, #020420, #0F172A)"}:{background:"linear-gradient(to bottom, #AA96DA, #6962AD)"},padding:5},children:[e.jsx(S,{maxWidth:"xl",sx:{position:"sticky",top:"3.25rem",left:0,width:"100%",zIndex:2,flexGrow:1,marginTop:10,padding:3,overflowX:"auto",overflowY:"hidden"},children:e.jsx(S,{children:e.jsx("form",{onSubmit:o=>{o.preventDefault(),ke()},children:e.jsxs(f,{container:!0,spacing:2,direction:"row",sx:{display:"flex",justifyContent:"center",alignItems:"center",...oe==="dark"?{background:"linear-gradient(to bottom, #040822, #040822)"}:{background:"linear-gradient(to bottom, #fff, #fff)"},borderRadius:"50px",width:"78rem"},children:[e.jsxs(f,{children:[e.jsx(d,{children:"Select Date"}),e.jsx(k,{dateAdapter:A,adapterLocale:"th",children:e.jsxs(se,{style:{position:"relative"},children:[e.jsx(ne,{className:"datetime-picker",format:"DD MMMM YYYY",value:c,onChange:K}),e.jsx("img",{className:"position-absolute top-0 right-0",style:{pointerEvents:"none",transform:"translate(-50%,20%)"},src:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Tear-Off%20Calendar.png",alt:"Stopwatch",width:"25",height:"25"})]})})]}),e.jsxs(f,{children:[e.jsx(d,{children:"Select Start Time"}),e.jsx(k,{dateAdapter:A,adapterLocale:"th",children:e.jsxs(Y,{style:{width:"120px",position:"relative"},children:[e.jsx(z,{className:"TimePicker",format:"HH:00",views:["hours"],value:m,onChange:Q,shouldDisableTime:Z}),e.jsx("img",{className:"position-absolute top-0 right-0",style:{pointerEvents:"none",transform:"translate(-50%,20%)"},src:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Travel%20and%20places/Stopwatch.png",alt:"Stopwatch",width:"25",height:"25"})]})})]}),e.jsxs(f,{children:[e.jsx(d,{children:"Select End Time"}),e.jsx(k,{dateAdapter:A,adapterLocale:"th",children:e.jsxs(Y,{style:{width:"120px",position:"relative"},children:[e.jsx(z,{className:"TimePicker",format:"HH:00",views:["hours"],value:h,onChange:V,shouldDisableTime:ee}),e.jsx("img",{className:"position-absolute top-0 right-0",style:{pointerEvents:"none",transform:"translate(-50%,20%)"},src:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Travel%20and%20places/Stopwatch.png",alt:"Stopwatch",width:"25",height:"25"})]})})]}),e.jsxs(f,{children:[e.jsx(d,{children:"ชั้น"}),e.jsx(L,{style:{width:"100%"},placeholder:"ชั้น",onChange:(o,t)=>{F({target:{name:"room_level",value:t}}),i(t)},children:Ce.map(o=>e.jsx(O,{value:o,children:o},o))})]}),e.jsxs(f,{children:[e.jsx(d,{children:"ห้อง"}),e.jsx(L,{style:{width:"100%"},placeholder:"ห้อง",onChange:(o,t)=>F({target:{name:"room_number",value:t}}),children:we.map(o=>e.jsx(O,{value:o.room_number,children:o.room_number},o.room_id))})]}),e.jsxs(f,{children:[e.jsx(d,{children:"ประเภทห้อง"}),e.jsx(L,{style:{width:"100%"},placeholder:"เลือกประเภทห้อง",onChange:(o,t)=>F({target:{name:"room_type",value:t}}),children:be.map(o=>e.jsx(O,{value:o,children:o},o))})]}),e.jsxs(f,{children:[e.jsx(d,{children:"จำนวนคน"}),e.jsx(L,{style:{width:"100%"},placeholder:"เลือกจำนวนคน",onChange:(o,t)=>F({target:{name:"room_capacity",value:t}}),children:Re.map(o=>e.jsx(O,{value:o,children:o},o))})]}),e.jsx(f,{children:e.jsxs(b,{sx:{marginTop:2},type:"submit",color:"primary",variant:"solid",children:[e.jsx("img",{style:{marginRight:"10px"},src:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Telegram-Animated-Emojis/main/Objects/Magnifying%20Glass%20Tilted%20Left.webp",alt:"Magnifying Glass Tilted Left",width:"25",height:"25"}),"Search Room"]})})]})})})}),e.jsx(S,{children:e.jsxs(Ee,{maxWidth:"xl",sx:{display:"flex",justifyContent:"center",borderRadius:10,padding:6,width:"100%",margin:0},children:[G.recommended_rooms&&G.recommended_rooms.length>0?e.jsx(S,{children:e.jsx(le,{data:G.recommended_rooms,isRecommended:!0,onConfirmClick:(o,t)=>{E(!0),l(o),w(r=>({...r,room_id:t}))},onReportClick:(o,t)=>{P(!0),l(o),w(r=>({...r,room_id:t}))}})}):R.availableRooms&&R.availableRooms.length>0?e.jsx(S,{children:e.jsx(le,{data:R.availableRooms,isRecommended:!1,onConfirmClick:(o,t)=>{E(!0),l(o),w(r=>({...r,room_id:t}))},onReportClick:(o,t)=>{P(!0),l(o),w(r=>({...r,room_id:t}))}})}):e.jsxs(S,{sx:{display:"flex",justifyContent:"center",alignItems:"center",gap:2,flexDirection:"column",background:"white",borderRadius:"20px",padding:5,backgroundColor:Pe.palette.background.backdrop},children:[e.jsx(I,{level:"h1",color:"primary",sx:{width:"100%",fontSize:"24px",textAlign:"center"},children:"No Data"}),e.jsx("img",{src:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/People%20with%20professions/Detective%20Light%20Skin%20Tone.png",alt:"Detective Light Skin Tone",width:"200",height:"200"})]}),B&&e.jsx(ae,{open:B,onClose:H,children:e.jsxs(ie,{size:"lg",layout:"center",color:"primary",sx:{width:450},children:[e.jsxs(v,{children:[e.jsx(d,{children:"Room"}),e.jsx($,{required:!0,name:"room_id",value:X.room_id,onChange:o=>w(t=>({...t,room_id:o.target.value})),fullWidth:!0,size:"lg",readOnly:!0,color:"primary"})]}),e.jsxs(v,{children:[e.jsx(d,{children:"Select Date"}),e.jsx(k,{dateAdapter:A,adapterLocale:"th",children:e.jsx(se,{sx:{width:"50%"},children:e.jsx(ne,{className:"datetime-picker",format:"DD MMMM YYYY",value:c,onChange:K,readOnly:!0})})})]}),e.jsxs(v,{children:[e.jsx(d,{children:"Start Time"}),e.jsx(k,{dateAdapter:A,adapterLocale:"th",children:e.jsx(Y,{sx:{width:"50%"},children:e.jsx(z,{className:"TimePicker",format:"HH:00",views:["hours"],value:m,onChange:Q,shouldDisableTime:Z,readOnly:!0})})})]}),e.jsxs(v,{children:[e.jsx(d,{children:"End Time"}),e.jsx(k,{dateAdapter:A,adapterLocale:"th",children:e.jsx(Y,{sx:{width:"50%"},children:e.jsx(z,{className:"TimePicker",format:"HH:00",views:["hours"],value:h,onChange:V,shouldDisableTime:ee,readOnly:!0})})})]}),e.jsxs(v,{children:[e.jsx(d,{children:"Reservation reason"}),e.jsx($,{color:"primary",required:!0,name:"reservation_reason",value:C,onChange:o=>_(o.target.value),fullWidth:!0,size:"lg"})]}),e.jsxs("div",{className:"d-flex gap-3 w-100 w-auto",children:[e.jsx(b,{onClick:Ae,children:"Confirm"}),e.jsx(b,{color:"neutral",onClick:H,children:"Cancel"})]})]})}),J&&e.jsx(ae,{open:J,onClose:H,children:e.jsxs(ie,{size:"lg",layout:"center",color:"primary",sx:{width:450},children:[e.jsxs(v,{children:[e.jsxs(v,{children:[e.jsx(d,{children:"Room"}),e.jsx($,{required:!0,name:"room_id",value:X.room_id,onChange:o=>w(t=>({...t,room_id:o.target.value})),fullWidth:!0,size:"lg",readOnly:!0,color:"primary"})]}),e.jsx(d,{required:!0,children:"Report detail"}),e.jsx($,{required:!0,name:"report_detail",value:n,onChange:o=>g(o.target.value),fullWidth:!0,size:"lg",color:"primary"})]}),e.jsxs("div",{className:"d-flex gap-3",children:[e.jsx(b,{color:"danger",onClick:Te,children:"Report"}),e.jsx(b,{color:"neutral",onClick:H,children:"Cancel"})]})]})})]})})]})};export{wo as default};
